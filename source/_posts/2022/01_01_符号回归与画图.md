---
disableNunjucks: true
mathjax: true
title: 符号回归与画图
tags:
  - Python
  - 机器学习
categories:
  - 计算机与通信工程
description: >-
  这篇文章介绍了符号回归中通过Python库gplearn生成复杂公式，并利用Graphviz将其以树状图形式直观化表示的方法。文中详细介绍了Graphviz的功能、安装步骤及其通过dot语言生成图形的过程。最后通过Python代码示例说明如何生成树状图文件并保存为PDF格式。
date: 2022-01-01 16:09:15
---

>符号回归得到的公式形式往往复杂。为了使结果更加直观，可以用树状图表示。

<!--more-->

### gplearn

本文所用到的符号回归Python库是`gplearn`，官方文档[在这里](https://gplearn.readthedocs.io/en/stable/intro.html)，程序例子[在这里](https://gplearn.readthedocs.io/en/stable/examples.html)。

![Tree view of the solution](/notes/images/ex1_child.png){#fig:tree-view}

`gplearn`生成的公式，比如

```
sub(add(-0.999, X1), mul(sub(X1, X0), add(X0, X1)))
```

可以转变为如[@fig:tree-view]所示的树状图。

### Graphviz

>Graphviz是一款由AT&TResearch和LucentBell实验室开源的可视化图形工具，可以很方便的用来绘制结构化的图形网络，支持多种格式输出。
Graphviz输入是一个用dot语言编写的绘图脚本，通过对输入脚本的解析，分析出其中的点、边及子图，然后根据属性进行绘制。
Graphviz layout以简单的文本语言描述图形，并以实用的格式制作图表，如用于网页的images和SVG；用于放入在其它文件中或显示在交互式图形浏览器中的PDF和Postscript。

首先需要先下载Graphviz软件。
根据[Graphviz官网](http://graphviz.org/download/)，
Ubuntu等系统可以包管理工具通过指令安装：

```sh
sudo apt install graphviz
```

Windows 10则选择最新的64位安装包：
[graphviz 2.50.0 win64.exe](https://gitlab.com/api/v4/projects/4207231/packages/generic/graphviz-releases/2.50.0/windows_10_cmake_Release_graphviz-install-2.50.0-win64.exe)。

然后安装Graphviz的Python库：

```powershell
conda install graphviz
```

或者

```powershell
pip install graphviz
```

### Python画图

```python
# ... gplearn imports ...
import graphviz

# ... gplearn 程序 ...

dot_data = est._program.export_graphviz()
graph = graphviz.Source(dot_data)
graph.view(filename="my_picture", directory=".")
```

参考官网给出的例子，使用上述代码可以在当前文件夹生成如[@fig:tree-view]所示的树状图，文件名为`my_picture.pdf`。

[Fin.]{.display-block .text-indent-none .mt-4 .mb-2 .fw-600}
